import { useEffect, useState } from 'react';
import {
    Dimensions,
    StyleSheet,
    Text,
    TouchableOpacity,
    View,
} from 'react-native';
import LinearGradient from 'react-native-linear-gradient';
import SoundPlayer from 'react-native-sound-player';
import Svg, { Rect } from 'react-native-svg';
import {
    PauseIcon,
    PlayIcon,
} from '../../../assets/images/svgs';
import { width } from '../../../constant';
import { colors } from '../../../utils/colors';

const waveform = [
  0.6979039026148278, 0.6471610407462582, 0.5074104947395217,
  0.6581623104818302, 0.6081266613040311, 0.6739381164718166, 0.73907897026027,
  0.6534323558224038, 0.7251830860607159, 0.6182222522744703,
  0.4837201444154889, 0.5790424280110833, 0.5626505867843531,
  0.5843922320210235, 0.6117384230817735, 0.5280856721803264,
  0.5475512399507633, 0.5732174866286841, 0.58366631466344, 0.6742325834641103,
  0.712936210441577, 0.6803872149067316, 0.6494889036383709, 0.60690543464274,
  0.4805559160218153, 0.5816547382262028, 0.6751372228069954,
  0.5375156558313062, 0.5186486807203666, 0.5702365955797666,
  0.5298025430188379, 0.5974268884090733, 0.5767066762848848,
  0.4065864038575466, 0.3733736695165983, 0.5067841583533697,
  0.5160831223291348, 0.4561528678523403, 0.4299931780717157,
  0.4709345548338692, 0.5057867347036779, 0.5146845120073305,
  0.4594665615762953, 0.3742179110026773, 0.4583808411371372,
  0.5210171804988574, 0.4661064390687599, 0.4955126620768111,
  0.3286442618843614, 0.4437758966690382, 0.446059638798348, 0.4960481562534064,
  0.4967733704610233, 0.3857361481810953, 0.372889898903551, 0.4461960610027802,
  0.469557409518737, 0.3716152975355989, 0.3776840578888589, 0.3584743036990296,
  0.3762558690707924, 0.3308412606563323, 0.5193575861424622,
  0.6551029610556803, 0.6491261333742053, 0.5582590454967075,
  0.6015915418748436, 0.6674249476535768, 0.6483752864371084,
  0.7233274791497133, 0.621785800421385, 0.4778045418085232, 0.6116043149519238,
  0.5601660965356763, 0.434349661995541, 0.6164270977026542, 0.6355228836238742,
  0.6188274042848418, 0.5106687512691418, 0.6322446548153622, 0.611845673114997,
  0.5988762684672136, 0.6891782834515826, 0.7017841309676932,
  0.4428570422994533, 0.5748621975388283, 0.4543929454395986,
  0.3845855889555246, 0.5675949697523586, 0.6183802166299691,
  0.5598542192085992, 0.4853885922813043, 0.518684164443276, 0.4673738320991954,
  0.5202414505985143, 0.4642373300398901, 0.4074823518452193,
  0.4352030711344724, 0.548844555685213, 0.5477455660477362, 0.4294133645998431,
  0.4942850635611793, 0.4429030584287616, 0.5747130094151384,
  0.5453733135442682, 0.5035957251807697, 0.4161723077007961,
  0.4599862232858007, 0.4519102448550769, 0.4831618818185378,
  0.5379164797173079, 0.4484598670924634, 0.3736151867051469,
  0.4711842364520989, 0.5363101580298719, 0.5581649710430598,
  0.4270814011481452, 0.4168327254472051, 0.4698500843939657,
  0.4487302790040619, 0.4151019202784948, 0.361162417919597, 0.39325322074917,
  0.4020587214323813, 0.3805738806733049, 0.6883713661160455,
  0.7014252695342962, 0.561565915563348, 0.7149420565731273, 0.6275280347864314,
  0.4713921388356139, 0.5196406961391618, 0.5201002009257618,
  0.4598996795530246, 0.4799915765837792, 0.5683561956381546,
  0.6283994792494922, 0.508402629006386, 0.5530445496358657, 0.5565300621193254,
  0.5011634249337499, 0.607503006723146, 0.643862598943908, 0.5031481536248988,
  0.6207152156574726, 0.6556978070684045, 0.5645325794763055,
  0.6521624933984242, 0.6251852689620031, 0.4561967242849004,
  0.4697664934965289, 0.4221064846165439, 0.4466956975090325,
  0.3742780997316723, 0.5949321258390011, 0.5457970432619811,
  0.4855469994283929, 0.3776247193349164, 0.4600294851859429,
  0.4295100877712055, 0.4362424697088245, 0.4016283925206708,
  0.5038565037536157, 0.4096825056584177, 0.4533759424942104,
  0.4541721732132631, 0.4132051778598511, 0.4898701977410448,
  0.4379815783717454, 0.5262555155511014, 0.5537764099479447,
  0.4307161778318223, 0.3246320733167538, 0.4577273898888727,
  0.4730912940167356, 0.4278609969228678, 0.3900032517210525,
  0.4920470899390619, 0.4908828823404072, 0.4109313135203689,
  0.4135137037326407, 0.4438676126004965, 0.3753589104039535,
  0.3385009055128443, 0.3567295357092866, 0.3868813175701916,
  0.3633789386814066, 0.5704784608630938, 0.6448185008008057,
  0.5541258525514402, 0.6682998113688458, 0.5946225365476947,
  0.6113359465512936, 0.5395147733306255, 0.5736069614538352,
  0.4816813333810644, 0.5150437342598482, 0.5812451400562388,
  0.5474540332386213, 0.532224582992643, 0.649537246330234, 0.426005702980655,
  0.4886974006485906, 0.4445545047847128, 0.5827931729723803,
  0.5296655365440605, 0.5198175090843694, 0.5033720220239066,
  0.5709314887499268, 0.5205590282202671, 0.6136106399920256,
  0.6380995605634424, 0.596727918419099, 0.4765823753793159, 0.55684509919345,
  0.5679301227764064, 0.4554941950346972, 0.549585888144787, 0.5230180951849269,
  0.5536492473972147, 0.5161546755947711, 0.5013136711710926, 0.518755119726895,
  0.4245317630566102, 0.5714441822077518, 0.5832009169556804,
  0.4495399303168354, 0.3732528190102776, 0.3251564433773619,
  0.4527994680809484, 0.501988856229161, 0.5289796109818053, 0.4165789170485084,
  0.5322585642849977, 0.4402212102467291, 0.457247223577985, 0.4511075028441801,
  0.4168327254472051, 0.3757180973106106, 0.397010151516368, 0.4793857128506869,
  0.4466049219833127, 0.3967358251419475, 0.4225536215495314,
  0.4473755614551757, 0.329525751761134, 0.3621149453191552, 0.3838926396642131,
  0.3563400037226924, 0.4450114783599038, 0.663486265163454, 0.6140904782254163,
  0.632396607352756, 0.6304162635925188, 0.5610377909120867, 0.7725046480574941,
  0.7177295181285819, 0.575696434867956, 0.6446715995023105, 0.5842761887710045,
  0.5771810420862388, 0.717567274711515, 0.7346870695767287, 0.6189851020371188,
  0.608316250836607, 0.508769269799491, 0.4734216708782553, 0.3516130984542477,
  0.4063222899199954, 0.5111417873329026, 0.4853093567222003,
  0.5716851791436922, 0.5783935806792552, 0.5398135676876771,
  0.5703877818230718, 0.3552327213055337, 0.3673783330865407,
  0.4014668299786286, 0.4520883172380372, 0.4965445449782246,
  0.5089158030656102, 0.5029614701798543, 0.4272277498106248,
  0.4373718137731762, 0.5372816095678025, 0.4911160889844108,
  0.4446002364295618, 0.4886974006485906, 0.4647057607664873,
  0.3792806919363488, 0.4269349717335601, 0.3830816985129502,
  0.3837190939133291, 0.3739770040968031, 0.3607803089279784,
  0.3183907729594644, 0.3603975685776575, 0.3486752634093172,
  0.3788677651730326, 0.3748791537208931, 0.3325106190377382,
  0.3624315881842601, 0.3461068616948395, 0.3440581781065896, 0.311957774815968,
  0.3233531940295925, 0.3321488080405868, 0.3211536075426626,
  0.3190848950558861, 0.3355975855579293, 0.3179267441632533,
  0.3224457921756721, 0.7066285850781013, 0.76354026052127, 0.6976054814255432,
  0.7262765243629321, 0.7792076900643984, 0.6330290623706685,
  0.6903095225972673, 0.7098051549427433, 0.6018122690466419,
  0.5860993156784624, 0.5506465982393858, 0.4397095906925758,
  0.4728846160306485, 0.4907662103122571, 0.48814850105671, 0.5418314313435943,
  0.5455037510470101, 0.455889584819259, 0.465937026655578, 0.4999210313236203,
  0.4508841061689701, 0.3918576017973688, 0.3985408501640515,
  0.4925115000105024, 0.5151514194748933, 0.3809253707805614,
  0.4703511186319783, 0.4963537235458143, 0.4090035229901399,
  0.4288807586867776, 0.4734216708782553, 0.3361671154612658,
  0.3938648153012644, 0.3730109337822543, 0.3228243486954624,
  0.3480022080688026, 0.3294524320267186, 0.3756582702599367,
  0.3580232254270088, 0.2854233047885799, 0.3600781340994524,
  0.3738564593147562, 0.3338081683884704, 0.3233531940295925,
  0.3477324214006805, 0.3736755277625008, 0.3492122640182715,
  0.3256795260874934, 0.3782174468583665, 0.3315686509880325,
  0.3545788672185252, 0.3716152975355989, 0.366011233434775, 0.3575712615879921,
  0.3636309159208776, 0.3116388017058347, 0.3453578559348329,
  0.3506824646065881, 0.3067937088842358, 0.3300382924136694,
  0.3385009055128443, 0.326275768752128, 0.4731739237312989, 0.7496062777398872,
  0.7309550637325617, 0.6463574596271402, 0.646528061608194, 0.5351000877660904,
  0.6345928391659768, 0.5099760753373537, 0.4796686059832621,
  0.6558879589235268, 0.6368510075121366, 0.4064807911076531,
  0.5645018129252466, 0.6030237895016258, 0.4881877419751367,
  0.4441425762016166, 0.6286809694507733, 0.6572636898719398,
  0.5263593941820023, 0.5139648102622788, 0.6300596739184662,
  0.6366007862138718, 0.5118318387814929, 0.6314839404302737,
  0.6300851562100658, 0.4352977276565846, 0.5160115525038909,
  0.5480691845336128, 0.4862192806716094, 0.5430163868810902,
  0.5436072342272653, 0.4928207047854571, 0.5497468240754911,
  0.4979908341449056, 0.5090256569488992, 0.4542605030730819,
  0.4105677043551846, 0.3792217456838023, 0.3610987768208436,
  0.3293790873177498, 0.3327996339474388, 0.3678116559650894,
  0.3593096858568007, 0.3476649241385307, 0.4051038266413327,
  0.3722231035878945, 0.3686142877067872, 0.4259076953707773,
  0.3678116559650894, 0.3885891030725726, 0.3439209285706514,
  0.3430956508649576, 0.3757779094097227, 0.3471918749199483,
  0.3716152975355989, 0.3328718275813664, 0.3527380468382127,
  0.3595661193419709, 0.3397635178955332, 0.3216866410348583,
  0.3165284466508325, 0.3237301349669259, 0.3352408743279215,
  0.5719560942283505, 0.6840908952968818, 0.6489567195996643,
  0.7207998457440357, 0.5528533599919004, 0.4476470378686546,
  0.5314420059996708, 0.5836372458755589, 0.420760489727772, 0.596055583339192,
  0.6042311406876042, 0.4332075546351388, 0.4555821077598349,
  0.4575965169215928, 0.3815684466400114, 0.5367460018910993,
  0.5137846220136325, 0.561845170309935, 0.523856766774218, 0.5359073114508603,
  0.5393818863994009, 0.5196053214839842, 0.5493926599045951,
  0.6173521998182224, 0.569994555695696, 0.59837524170023, 0.6257272555656267,
  0.5799546133260487, 0.547518840949597, 0.560384235666057, 0.4828823514551338,
  0.4544370789266214, 0.4775605197772884, 0.4052100118296025,
  0.3955803547200086, 0.4315332196559977, 0.4564597186871007,
  0.4614964550924954, 0.3414358475117673, 0.4130507766855333,
  0.4255643827351036, 0.3861375673141975, 0.3496810934424702,
  0.3505492042874813, 0.3721016667986285, 0.4330644491637382,
  0.3751191524301269, 0.3985408501640515, 0.4246795273945955,
  0.3549060280342292, 0.3591813622400415, 0.3631897767575124, 0.344195343208142,
  0.3312052616671529, 0.3502824480193814, 0.3479347917282638,
  0.3387118440340107, 0.3336643781628224, 0.3398334515046854,
  0.3270187400527644, 0.3303306266363288, 0.3308412606563323,
  0.3312779883834378, 0.33149602193455, 0.3368060700188481, 0.3200834810988499,
  0.3271670251916622, 0.3365223203225222, 0.3362382025554169,
  0.3267218611958761, 0.3359537155104417, 0.334955085211751, 0.3347404974867711,
  0.3345973216230891, 0.3317863920469285, 0.3356688579741072,
  0.3269445589447046, 0.3327996339474388, 0.3403223676434906,
  0.3306225653552055, 0.3253060265931874, 0.3409493892391487,
  0.3291589031284416, 0.3335204928284362, 0.3303306266363288,
  0.3321488080405868, 0.3278330409774433, 0.3401129646487692,
  0.3115589811830474, 0.3434398883775064, 0.3355975855579293,
  0.3408798078716503, 0.3198534589163579, 0.3290119884013022,
  0.3326551746077849, 0.3331603623476327, 0.3301114131218254,
  0.3373017499251418, 0.3212298376520768, 0.334955085211751, 0.3454942253890292,
  0.3418519634276396, 0.3430267394094357, 0.3435086720432901,
  0.3336643781628224, 0.3420597289708605, 0.3477324214006805,
  0.3376551226590409, 0.3459028358003368, 0.3357401071583602,
  0.3343823813675871, 0.3412274962149807, 0.3473947322496457,
  0.3388523575198488, 0.3356688579741072, 0.3348835794202616,
  0.3499485596730551, 0.3339518636638949, 0.3372310070555138,
  0.3328718275813664, 0.3473947322496457, 0.337584493599186, 0.3418519634276396,
  0.3465822009246092, 0.3380079277276674, 0.3478673551802479,
  0.3410189487399199, 0.3466500243375815, 0.3465822009246092,
  0.3439209285706514, 0.3482043359979862, 0.3461748290524371,
  0.3479347917282638, 0.3433710834549287, 0.3496810934424702,
  0.3432334097730895, 0.3428888524121048, 0.3444009328320997,
  0.3496141773795933, 0.3492792992937082, 0.3276852162204721,
  0.3481369801884391, 0.3395535840093843, 0.3431645409806239, 0.331858923768026,
  0.3414358475117673, 0.3392733610275933, 0.3516130984542477,
  0.3402525886922804, 0.3523416419065707, 0.3493463146632266,
  0.3482716716609544, 0.326870352114236, 0.3369478072159461, 0.3417826649827674,
  0.3402525886922804, 0.345834785842251, 0.3436461756706538, 0.3274632877888338,
  0.3529359905229066, 0.3471918749199483, 0.3464464925335965,
  0.3549714040381763, 0.3550367613538412, 0.341296968421843, 0.3516794263691742,
  0.344332424006139, 0.3468533716338686, 0.3602698477045346, 0.3435774344688296,
  0.3441267712034796, 0.347259514385731, 0.3536603151863393, 0.3434398883775064,
  0.342612821604067, 0.3506824646065881, 0.3565348523801807, 0.3440581781065896,
  0.3453578559348329, 0.3401827876998962, 0.356144989382863, 0.3436461756706538,
  0.3547097877579917, 0.3444009328320997, 0.3543823456057013,
  0.3495472414850552, 0.3551020999946707, 0.3631266886267811, 0.351347592698009,
  0.3524738536906163, 0.345834785842251, 0.3505492042874813, 0.3560148876018842,
  0.3620515649366605, 0.354513378801624, 0.3531996479185853, 0.3552980040023828,
  0.3489439235589712, 0.3576358822350972, 0.3571831558460016,
  0.3400431195213096, 0.3516794263691742, 0.3515467511439701, 0.350215709777685,
  0.3389927814181592, 0.3428888524121048, 0.3570536414855703, 0.329599046542458,
  0.3437148956652708, 0.3580232254270088, 0.3576358822350972,
  0.3482716716609544, 0.3256048785010736, 0.3508822081438752,
  0.3370186414672001, 0.3566646596142726, 0.3484735579220801,
  0.3484062826078508, 0.3524738536906163, 0.3539231361892657,
  0.3583455143021285, 0.3580232254270088, 0.350482544696052, 0.3610351182449424,
  0.3505492042874813, 0.3600781340994524, 0.354775219907623, 0.3522093531655603,
  0.3626213670911341, 0.3432334097730895, 0.3515467511439701, 0.356144989382863,
  0.3554937404191716, 0.3550367613538412, 0.3445378874193564,
  0.3533971908145546, 0.3610987768208436, 0.351015272710309, 0.3407405794670722,
  0.3544478716018737, 0.3579587134846883, 0.3515467511439701,
  0.3577004847327178, 0.3526059886303631, 0.356599765175592, 0.3526720273187606,
  0.3571184077921026, 0.3584743036990296, 0.3602698477045346,
  0.3551674199740961, 0.3390629598169884, 0.3589887429415513,
  0.3594379381909161, 0.3541200533847902, 0.3608440375334447,
  0.3404618594925493, 0.3626213670911341, 0.3640083718720562,
  0.3623049828003256, 0.3494133101417138, 0.3348835794202616,
  0.3612896477339275, 0.3560799477232678, 0.3080970024212724,
  0.3521431799009115, 0.3453578559348329, 0.3604614025918804,
  0.3338081683884704, 0.3623049828003256, 0.3641968710629797,
  0.3570536414855703, 0.3439209285706514, 0.3219146727470358,
  0.3595020376581111, 0.3467178272497115, 0.3619881672566726,
  0.3363803075231108, 0.348876788530006, 0.3559498090055109, 0.3541200533847902,
  0.354775219907623, 0.3602059608211541, 0.3564699212149592, 0.3598222684921207,
  0.3583455143021285, 0.3614168077843357, 0.3580232254270088,
  0.3603337169526203, 0.3486080483077176, 0.3475298687928655,
  0.3523416419065707, 0.3585386714153642, 0.3571184077921026,
  0.3628741650125877, 0.3465143569951639, 0.3567943934736837,
  0.3634419585386884, 0.3505492042874813, 0.3483389871925225,
  0.3585386714153642, 0.3554937404191716, 0.3516794263691742,
  0.3668200271411848, 0.351015272710309, 0.3641340549157305, 0.3587959626946822,
  0.3530678573910324, 0.3618613199566661, 0.3633789386814066,
  0.3556241384357302, 0.3586673529469986, 0.3578941834568762,
  0.3594379381909161, 0.3598222684921207, 0.3505492042874813,
  0.3607803089279784, 0.3541856547026914, 0.3500153767992372,
  0.3618613199566661, 0.3552327213055337, 0.3564049716668329,
  0.3612260415532725, 0.3520107755126183, 0.3610987768208436,
  0.3503491665765966, 0.3573125972476649, 0.3593096858568007,
  0.3559498090055109, 0.3616074172629473, 0.3586030211604787, 0.361162417919597,
  0.3489439235589712, 0.3610987768208436, 0.3580232254270088,
  0.3603975685776575, 0.3573772906212758, 0.3493463146632266,
  0.3609714421798094, 0.3573125972476649, 0.3602059608211541,
  0.3555589487113602, 0.3558847119209333, 0.3549060280342292,
  0.3480022080688026, 0.3573772906212758, 0.3506824646065881,
  0.3551674199740961, 0.3470565348434394, 0.354316800799519, 0.3347404974867711,
  0.3518782938845247, 0.3516130984542477, 0.3403921245710728,
  0.3520769873546504, 0.3430267394094357, 0.3498148661324141, 0.345970865084584,
  0.3422673001840986, 0.3543823456057013, 0.3462427757993748,
  0.3536603151863393, 0.341296968421843, 0.3455623789543547, 0.3524738536906163,
  0.3481369801884391, 0.3557544622342255, 0.3520769873546504,
  0.3520107755126183, 0.3487424584702016, 0.3511482591783004,
  0.3551674199740961, 0.3542512371697229, 0.3582166528684876,
  0.3425437603014767, 0.3575712615879921, 0.3594379381909161,
  0.3573125972476649, 0.3337362851543215, 0.3586030211604787,
  0.3518782938845247, 0.3484735579220801, 0.3579587134846883,
  0.3596301832549103, 0.3392032496037825, 0.3500153767992372,
  0.3477998984094831, 0.3482043359979862, 0.3517457349030253,
  0.3531996479185853, 0.3564049716668329, 0.3573125972476649,
  0.3422673001840986, 0.3563400037226924, 0.3571184077921026,
  0.3523416419065707, 0.3573772906212758, 0.3505492042874813,
  0.3583455143021285, 0.3556893096055873, 0.351347592698009, 0.3613532364736052,
  0.3559498090055109, 0.3610987768208436, 0.3565348523801807,
  0.3608440375334447, 0.3577650690936819, 0.3564699212149592,
  0.3592455329649845, 0.3592455329649845, 0.3573772906212758,
  0.3520769873546504, 0.3600141942365682, 0.3581521951061754,
  0.3592455329649845, 0.3563400037226924, 0.3587316667875343,
  0.3555589487113602, 0.3473271334904833, 0.3600781340994524,
  0.3527380468382127, 0.3564049716668329, 0.3533313622167814,
  0.3475974066077082, 0.3591813622400415, 0.3523416419065707,
  0.3579587134846883, 0.3510817756993926, 0.3545788672185252,
  0.3478673551802479, 0.3494802857440395, 0.3528700284263018,
  0.3514139982801699, 0.3514803844240478, 0.3502824480193814,
  0.3498817227890232, 0.3452896400140184, 0.3560148876018842,
  0.3469211131370603, 0.3575712615879921, 0.3641968710629797,
  0.3471242150776771, 0.3583455143021285, 0.3573125972476649,
  0.3579587134846883, 0.3560148876018842, 0.3609714421798094,
  0.3520107755126183, 0.3626845923288162, 0.350215709777685, 0.3607803089279784,
  0.3501489518368697, 0.360525219007508, 0.3418519634276396, 0.3583455143021285,
  0.3534630003965767, 0.3505492042874813, 0.3585386714153642,
  0.3535945625686641, 0.3578941834568762, 0.344195343208142, 0.3556241384357302,
  0.3595661193419709, 0.357441965793946, 0.3585386714153642, 0.3394135170254837,
  0.3583455143021285, 0.3488096335054206, 0.3595020376581111,
  0.3554937404191716, 0.3596301832549103, 0.3560148876018842,
  0.3304766453493011, 0.3595661193419709, 0.3578941834568762,
  0.3571831558460016, 0.3575712615879921, 0.3534630003965767,
  0.3576358822350972, 0.3485408131503342, 0.3520769873546504,
  0.3560799477232678, 0.3534630003965767, 0.3529359905229066,
  0.3547097877579917, 0.3399033629669145, 0.3533971908145546,
  0.3569240540627509, 0.3537917635538533, 0.3589245007591295,
  0.3483389871925225, 0.3586030211604787, 0.3569240540627509,
  0.3464464925335965, 0.3570536414855703, 0.3445378874193564,
  0.3617978703128402, 0.3494133101417138, 0.3469211131370603,
  0.3593096858568007, 0.3466500243375815, 0.3615438981670103,
  0.3508822081438752, 0.3510817756993926, 0.3600781340994524,
  0.3515467511439701, 0.3539231361892657, 0.3543823456057013,
  0.3552327213055337, 0.3572478856602119, 0.3572478856602119,
  0.3587316667875343, 0.3610351182449424, 0.3529359905229066,
  0.3580877192965906, 0.3530678573910324, 0.3407405794670722,
  0.3587316667875343, 0.3514803844240478, 0.3562100125938548, 0.350482544696052,
  0.3575066227785604, 0.3437148956652708, 0.3541856547026914,
  0.3551020999946707, 0.3539887941417532, 0.3580232254270088, 0.354316800799519,
  0.3575712615879921, 0.3592455329649845, 0.356988856913445, 0.3578941834568762,
  0.3594379381909161, 0.3573772906212758, 0.3537917635538533,
  0.3589245007591295, 0.3564699212149592, 0.3598222684921207, 0.357441965793946,
  0.3550367613538412, 0.3558847119209333, 0.3538574593312043,
  0.3596942294093269, 0.3545788672185252, 0.3580232254270088,
  0.3533971908145546, 0.3595020376581111, 0.3547097877579917,
  0.3557544622342255, 0.3558847119209333, 0.3522093531655603,
  0.3558847119209333, 0.3508822081438752, 0.3516794263691742,
  0.3575066227785604, 0.3516794263691742, 0.3597582578176068,
  0.3470565348434394, 0.3576358822350972, 0.3502824480193814, 0.356144989382863,
  0.3578941834568762, 0.3554285135458403, 0.6979039026148278,
];

const YudioPlayer = ({
  audioUrl,
  //   waveform,
}) => {
  const [isPlaying, setIsPlaying] = useState(false);
  const [duration, setDuration] = useState(0);
  const [currentTime, setCurrentTime] = useState(0);
  const fixedBarsCount = 35;

  useEffect(() => {
    SoundPlayer.loadUrl(audioUrl);
    const interval = setInterval(() => {
      SoundPlayer.getInfo()
        .then(info => {
          setCurrentTime(info.currentTime);
          setDuration(info.duration);
        })
        .catch(() => {});
    }, 500);

    return () => clearInterval(interval);
  }, [audioUrl]);

  const playPause = () => {
    if (isPlaying) {
      SoundPlayer.pause();
    } else {
      SoundPlayer.play();
    }
    setIsPlaying(!isPlaying);
  };

  const formatTime = seconds => {
    const minutes = Math.floor(seconds / 60);
    const remainingSeconds = Math.floor(seconds % 60);
    return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
  };

  const mappedWaveform =
    waveform && waveform.length > 0
      ? Array.from({length: fixedBarsCount}, (_, i) => {
          const start = Math.floor((i / fixedBarsCount) * waveform.length);
          const end = Math.floor(((i + 1) / fixedBarsCount) * waveform.length);
          const segment = waveform.slice(start, end);
          return (
            segment.reduce((sum, val) => sum + val, 0) / segment.length || 0
          );
        })
      : Array(fixedBarsCount).fill(0);

  const waveformWidth = Dimensions.get('window').width - 20;
  const barWidth = waveformWidth / fixedBarsCount - 2;
  const barHeightScale = 100;
  const progress = currentTime / duration;

  return (
    <View style={styles.container}>
      <TouchableOpacity onPress={playPause}>
        <LinearGradient
          colors={['#478FE4', '#5CD3C6']}
          start={{x: 0, y: 0}}
          end={{x: 1, y: 0}}
          style={[
            styles.playPauseButton,
            isPlaying ? styles.noPaddingLeft : styles.paddingLeft,
          ]}>
          {isPlaying ? <PauseIcon height={20} /> : <PlayIcon height={20} />}
        </LinearGradient>
      </TouchableOpacity>
      <View style={styles.flex1}>
        <View style={styles.timeRow}>
          <Text style={styles.timeText}>{formatTime(currentTime)}</Text>
          <Text style={styles.timeText}>{formatTime(duration)}</Text>
        </View>
        <View style={styles.waveformContainer}>
          <Svg
            height={barHeightScale - 30}
            width="100%"
            viewBox={`0 0 ${waveformWidth} ${barHeightScale}`}>
            {mappedWaveform.map((value, index) => {
              const barHeight = Math.max(value * barHeightScale, 3);
              const isFilled = index / fixedBarsCount <= progress;
              return (
                <Rect
                  key={index}
                  x={index * (barWidth + 2)}
                  y={(barHeightScale - barHeight) / 2}
                  width={barWidth}
                  height={barHeight}
                  fill={isFilled ? '#36AFD6' : '#D3D3D3'}
                  rx={barWidth / 2}
                  ry={barWidth / 2}
                />
              );
            })}
          </Svg>
        </View>
      </View>
    </View>
  );
};

const styles = StyleSheet.create({
  container: {
    width: '100%',
    flexDirection: 'row',
    gap: 12,
    justifyContent: 'space-between',
    alignItems: 'center',
    backgroundColor: colors?.extraLightGrey,
    padding: width * 0.04,
    borderRadius: width * 0.02,
  },
  playPauseButton: {
    marginTop: 12,
    width: 36,
    height: 36,
    borderRadius: 18,
    justifyContent: 'center',
    alignItems: 'center',
  },
  paddingLeft: {
    paddingLeft: 4,
  },
  noPaddingLeft: {
    paddingLeft: 0,
  },
  flex1: {
    flex: 1,
  },
  timeRow: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
  },
  timeText: {
    fontSize: 12,
    color: '#000',
  },
  waveformContainer: {
    width: '100%',
  },
});

export default YudioPlayer;
